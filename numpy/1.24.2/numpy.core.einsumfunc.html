<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>numpy.core.einsumfunc</title>
    <meta name="generator" content="pydoctor 22.9.1.dev0"> 
        
    </meta>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1" />
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="apidocs.css" />
    <link rel="stylesheet" type="text/css" href="extra.css" />
</head>

  <body>

    <div id="banner">    
    <div>
        <a href="/">Home</a>
        &gt; numpy-1.24.2 <!-- This is a placeholder -->
        
        <!-- (<a href=""&gt;show all versions</a&gt;) -->
    </div>
</div>

    <nav class="navbar navbar-default mainnavbar">
      
  
  <div class="container-fluid">


    <div class="navbar-header">
      
      <div class="navlinks">
        <span class="navbar-brand">
          numpy <a href="index.html">API Documentation</a>
        </span>

        <a href="moduleIndex.html">
          Modules
        </a>

        <a href="classIndex.html">
          Classes
        </a>

        <a href="nameIndex.html">
          Names
        </a>

        <div id="search-box-container">
          <div class="input-group">
            <input id="search-box" type="search" name="search-query" placeholder="Search..." aria-label="Search" minlength="2" class="form-control" autocomplete="off" />
            
            <span class="input-group-btn">
              <a style="display: none;" class="btn btn-default" id="search-clear-button" title="Clear" onclick="clearSearch()"><img src="fonts/x-circle.svg" alt="Clear" /></a>
              <a class="btn btn-default" id="search-help-button" title="Help" onclick="toggleSearchHelpText()"><img src="fonts/info.svg" alt="Help" /></a>
            </span>
          </div>
        </div>

      </div>

      <div id="search-results-container" style="display: none;">
        
        <div id="search-buttons">
          <span class="label label-default" id="search-docstrings-button">
          <label class="checkbox-inline">
            <input type="checkbox" id="toggle-search-in-docstrings-checkbox" value="false" onclick="toggleSearchInDocstrings()">
              search in docstrings
            </input>
          </label>
          </span>
          
        </div>
        
        <noscript>
            <h1>Cannot search: JavaScript is not supported/enabled in your browser.</h1>
        </noscript>

        <div class="hint" id="search-help-box">
          <p class="rst-last">
      
            Search bar offers the following options:
            <ul>   
                <li>
                  <strong>Term presence.</strong> The below example searches for documents that 
                    must contain “foo”, might contain “bar” and must not contain “baz”: <code>+foo bar -baz</code>
                </li> 

                <li>
                  <strong>Wildcards.</strong> The below example searches for documents with words beginning with “foo”: <code>foo*</code>
                </li> 

                <li>
                  <strong>Search in specific fields.</strong> The following search matches all objects 
                  in "twisted.mail" that matches “search”: <code>+qname:twisted.mail.* +search</code>

                  <p>
                    Possible fields: 'name', 'qname' (fully qualified name), 'docstring', and 'kind'.
                    Last two fields are only applicable if "search in docstrings" is enabled.
                  </p>
                </li>

                <li>
                  <strong>Fuzzy matches.</strong> The following search matches all documents 
                  that have a word within 1 edit distance of “foo”: <code>foo~1</code>
                </li>
            </ul>

          </p>
        </div>

        <div id="search-status"> </div>

        <div class="warning" id="search-warn-box" style="display: none;">
          <p class="rst-last"><span id="search-warn"></span></p>
        </div>

        <table id="search-results">
          <!-- Filled dynamically by JS -->
        </table>
        
        <div style="margin-top: 8px;">
          <p>Results provided by <a href="https://lunrjs.com">Lunr.js</a></p>
        </div>
      </div>

    </div>


  </div>
</nav>
    
    <div class="container-fluid">

      <!-- Side navigation -->
      <div class="sidebarcontainer" style="display: none;">
        
        <div class="sidebar"><nav class="sidebar">
  

  <div>

      <div class="thingTitle">
        <span>Module</span>
        <code class="thisobject"><a href="numpy.core.einsumfunc.html" class="internal-link" title="This module">einsumfunc</a></code> 
      </div>
      
      <div>
        

        
         

        
        

        <div class="childrenKindTitle">Functions</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="#einsum" class="internal-link" title="numpy.core.einsumfunc.einsum">einsum</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#einsum_path" class="internal-link" title="numpy.core.einsumfunc.einsum_path">einsum<wbr></wbr>_path</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_can_dot" class="internal-link" title="numpy.core.einsumfunc._can_dot">_can<wbr></wbr>_dot</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_compute_size_by_dict" class="internal-link" title="numpy.core.einsumfunc._compute_size_by_dict">_compute<wbr></wbr>_size<wbr></wbr>_by<wbr></wbr>_dict</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_einsum_dispatcher" class="internal-link" title="numpy.core.einsumfunc._einsum_dispatcher">_einsum<wbr></wbr>_dispatcher</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_einsum_path_dispatcher" class="internal-link" title="numpy.core.einsumfunc._einsum_path_dispatcher">_einsum<wbr></wbr>_path<wbr></wbr>_dispatcher</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_find_contraction" class="internal-link" title="numpy.core.einsumfunc._find_contraction">_find<wbr></wbr>_contraction</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_flop_count" class="internal-link" title="numpy.core.einsumfunc._flop_count">_flop<wbr></wbr>_count</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_greedy_path" class="internal-link" title="numpy.core.einsumfunc._greedy_path">_greedy<wbr></wbr>_path</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_optimal_path" class="internal-link" title="numpy.core.einsumfunc._optimal_path">_optimal<wbr></wbr>_path</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_parse_einsum_input" class="internal-link" title="numpy.core.einsumfunc._parse_einsum_input">_parse<wbr></wbr>_einsum<wbr></wbr>_input</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_parse_possible_contraction" class="internal-link" title="numpy.core.einsumfunc._parse_possible_contraction">_parse<wbr></wbr>_possible<wbr></wbr>_contraction</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_update_other_results" class="internal-link" title="numpy.core.einsumfunc._update_other_results">_update<wbr></wbr>_other<wbr></wbr>_results</a></code>
            </div>
        

    </li>
</ul> 

        
         

        <div class="childrenKindTitle">Variables</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="#einsum_symbols" class="internal-link" title="numpy.core.einsumfunc.einsum_symbols">einsum<wbr></wbr>_symbols</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#einsum_symbols_set" class="internal-link" title="numpy.core.einsumfunc.einsum_symbols_set">einsum<wbr></wbr>_symbols<wbr></wbr>_set</a></code>
            </div>
        

    </li>
</ul> 

        
         
        
      </div>
  </div><div>

      <div class="thingTitle">
        <span>Package</span>
        <code><a href="numpy.core.html" class="internal-link" title="The parent of this module">core</a></code> 
      </div>
      
      <div>
        

        <div class="childrenKindTitle">Modules</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.code_generators.html" class="internal-link" title="numpy.core.code_generators">code<wbr></wbr>_generators</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.tests.html" class="internal-link" title="numpy.core.tests">tests</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.arrayprint.html" class="internal-link" title="numpy.core.arrayprint">arrayprint</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.char.html" class="internal-link" title="numpy.core.char">char</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.cversions.html" class="internal-link" title="numpy.core.cversions">cversions</a></code>
            </div>
        

    </li><li class=" thisobject">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.einsumfunc.html" class="internal-link" title="numpy.core.einsumfunc">einsumfunc</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.fromnumeric.html" class="internal-link" title="numpy.core.fromnumeric">fromnumeric</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.function_base.html" class="internal-link" title="numpy.core.function_base">function<wbr></wbr>_base</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.getlimits.html" class="internal-link" title="numpy.core.getlimits">getlimits</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.memmap.html" class="internal-link" title="numpy.core.memmap">memmap</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.multiarray.html" class="internal-link" title="numpy.core.multiarray">multiarray</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.numeric.html" class="internal-link" title="numpy.core.numeric">numeric</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.numerictypes.html" class="internal-link" title="numpy.core.numerictypes">numerictypes</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.overrides.html" class="internal-link" title="numpy.core.overrides">overrides</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.rec.html" class="internal-link" title="numpy.core.rec">rec</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.setup.html" class="internal-link" title="numpy.core.setup">setup</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.setup_common.html" class="internal-link" title="numpy.core.setup_common">setup<wbr></wbr>_common</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.shape_base.html" class="internal-link" title="numpy.core.shape_base">shape<wbr></wbr>_base</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.umath.html" class="internal-link" title="numpy.core.umath">umath</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.umath_tests.html" class="internal-link" title="numpy.core.umath_tests">umath<wbr></wbr>_tests</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core._add_newdocs.html" class="internal-link" title="numpy.core._add_newdocs">_add<wbr></wbr>_newdocs</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core._add_newdocs_scalars.html" class="internal-link" title="numpy.core._add_newdocs_scalars">_add<wbr></wbr>_newdocs<wbr></wbr>_scalars</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core._asarray.html" class="internal-link" title="numpy.core._asarray">_asarray</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core._dtype.html" class="internal-link" title="numpy.core._dtype">_dtype</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core._dtype_ctypes.html" class="internal-link" title="numpy.core._dtype_ctypes">_dtype<wbr></wbr>_ctypes</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core._exceptions.html" class="internal-link" title="numpy.core._exceptions">_exceptions</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core._internal.html" class="internal-link" title="numpy.core._internal">_internal</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core._machar.html" class="internal-link" title="numpy.core._machar">_machar</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core._methods.html" class="internal-link" title="numpy.core._methods">_methods</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core._string_helpers.html" class="internal-link" title="numpy.core._string_helpers">_string<wbr></wbr>_helpers</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core._type_aliases.html" class="internal-link" title="numpy.core._type_aliases">_type<wbr></wbr>_aliases</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core._ufunc_config.html" class="internal-link" title="numpy.core._ufunc_config">_ufunc<wbr></wbr>_config</a></code>
            </div>
        

    </li>
</ul> 

        
        

        <div class="childrenKindTitle">Functions</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.html#__getattr__" class="internal-link" title="numpy.core.__getattr__">__getattr__</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.html#_DType_reconstruct" class="internal-link" title="numpy.core._DType_reconstruct">_<wbr></wbr>DType_reconstruct</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.html#_DType_reduce" class="internal-link" title="numpy.core._DType_reduce">_<wbr></wbr>DType_reduce</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.html#_ufunc_reconstruct" class="internal-link" title="numpy.core._ufunc_reconstruct">_ufunc<wbr></wbr>_reconstruct</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.html#_ufunc_reduce" class="internal-link" title="numpy.core._ufunc_reduce">_ufunc<wbr></wbr>_reduce</a></code>
            </div>
        

    </li>
</ul> 

        
         

        <div class="childrenKindTitle">Variables</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.html#env_added" class="internal-link" title="numpy.core.env_added">env<wbr></wbr>_added</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.html#msg" class="internal-link" title="numpy.core.msg">msg</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.html#path" class="internal-link" title="numpy.core.path">path</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="numpy.core.html#test" class="internal-link" title="numpy.core.test">test</a></code>
            </div>
        

    </li>
</ul> 

        
         
        
      </div>
  </div>

</nav>
        </div>
        <div id="collapseSideBar">
          <a class="btn btn-link" onclick="toggleSideBarCollapse()" title="Toggle Sidebar Collapse">
          </a>
        </div> 
        <script src="sidebartoggle.js" type="text/javascript"></script>
       
      </div>

      <div id="main" class="">
        

        

        <div class="page-header">
          <h1 class="module"><code><code><a href="index.html" class="internal-link">numpy</a></code><wbr></wbr>.<code><a href="numpy.core.html" class="internal-link" title="numpy.core">core</a></code><wbr></wbr>.<code><a href="numpy.core.einsumfunc.html" class="internal-link" title="numpy.core.einsumfunc">einsumfunc</a></code></code></h1>
          <div id="showPrivate">
            <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
          </div>
        </div>

        <div class="categoryHeader">
          module documentation
        </div>

        <div class="extrasDocstring">
          <a href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py" class="sourceLink">(source)</a>
          <p></p>
        </div>

        <div class="moduleDocstring">
          <div><p>Implementation of optimized einsum.</p></div>
        </div>

        <div id="splitTables">
          <table class="children sortable" id="id157">
  
  
  <tr class="function">
    
    <td>Function</td>
    <td><code><a href="#einsum" class="internal-link" title="numpy.core.einsumfunc.einsum">einsum</a></code></td>
    <td>casting='safe', optimize=False)</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#einsum_path" class="internal-link" title="numpy.core.einsumfunc.einsum_path">einsum<wbr></wbr>_path</a></code></td>
    <td>einsum_path(subscripts, *operands, optimize='greedy')</td>
  </tr><tr class="variable">
    
    <td>Variable</td>
    <td><code><a href="#einsum_symbols" class="internal-link" title="numpy.core.einsumfunc.einsum_symbols">einsum<wbr></wbr>_symbols</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="variable">
    
    <td>Variable</td>
    <td><code><a href="#einsum_symbols_set" class="internal-link" title="numpy.core.einsumfunc.einsum_symbols_set">einsum<wbr></wbr>_symbols<wbr></wbr>_set</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_can_dot" class="internal-link" title="numpy.core.einsumfunc._can_dot">_can<wbr></wbr>_dot</a></code></td>
    <td>Checks if we can use BLAS (np.tensordot) call and its beneficial to do so.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_compute_size_by_dict" class="internal-link" title="numpy.core.einsumfunc._compute_size_by_dict">_compute<wbr></wbr>_size<wbr></wbr>_by<wbr></wbr>_dict</a></code></td>
    <td>Computes the product of the elements in indices based on the dictionary idx_dict.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_einsum_dispatcher" class="internal-link" title="numpy.core.einsumfunc._einsum_dispatcher">_einsum<wbr></wbr>_dispatcher</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_einsum_path_dispatcher" class="internal-link" title="numpy.core.einsumfunc._einsum_path_dispatcher">_einsum<wbr></wbr>_path<wbr></wbr>_dispatcher</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_find_contraction" class="internal-link" title="numpy.core.einsumfunc._find_contraction">_find<wbr></wbr>_contraction</a></code></td>
    <td>Finds the contraction for a given set of input and output sets.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_flop_count" class="internal-link" title="numpy.core.einsumfunc._flop_count">_flop<wbr></wbr>_count</a></code></td>
    <td>Computes the number of FLOPS in the contraction.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_greedy_path" class="internal-link" title="numpy.core.einsumfunc._greedy_path">_greedy<wbr></wbr>_path</a></code></td>
    <td>Finds the path by contracting the best pair until the input list is exhausted. The best pair is found by minimizing the tuple <tt class="rst-docutils literal"><span class="pre">(-prod(indices_removed),</span> cost)</tt>.  What this amounts to is prioritizing matrix multiplication or inner product operations, then Hadamard like operations, and finally outer operations...</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_optimal_path" class="internal-link" title="numpy.core.einsumfunc._optimal_path">_optimal<wbr></wbr>_path</a></code></td>
    <td>Computes all possible pair contractions, sieves the results based on <tt class="rst-docutils literal">memory_limit</tt> and returns the lowest cost path. This algorithm scales factorial with respect to the elements in the list <tt class="rst-docutils literal">input_sets</tt>.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_parse_einsum_input" class="internal-link" title="numpy.core.einsumfunc._parse_einsum_input">_parse<wbr></wbr>_einsum<wbr></wbr>_input</a></code></td>
    <td>A reproduction of einsum c side einsum parsing in python.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_parse_possible_contraction" class="internal-link" title="numpy.core.einsumfunc._parse_possible_contraction">_parse<wbr></wbr>_possible<wbr></wbr>_contraction</a></code></td>
    <td>Compute the cost (removed size + flops) and resultant indices for performing the contraction specified by <tt class="rst-docutils literal">positions</tt>.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_update_other_results" class="internal-link" title="numpy.core.einsumfunc._update_other_results">_update<wbr></wbr>_other<wbr></wbr>_results</a></code></td>
    <td>Update the positions and provisional input_sets of <tt class="rst-docutils literal">results</tt> based on performing the contraction result <tt class="rst-docutils literal">best</tt>. Remove any involving the tensors contracted.</td>
  </tr>
</table>
          

            
        </div>

        <div id="childList">
          <div class="basefunction">
  
  
  <a name="numpy.core.einsumfunc.einsum">
    
  </a>
  <a name="einsum">
    
  </a>
  <div class="functionHeader">
    
    @<a href="numpy.core.overrides.html#array_function_dispatch" class="internal-link" title="numpy.core.overrides.array_function_dispatch">array_function_dispatch</a>(<wbr></wbr><a href="#_einsum_dispatcher" class="internal-link" title="numpy.core.einsumfunc._einsum_dispatcher">_einsum_dispatcher</a>, <wbr></wbr>module=<span class="rst-variable-quote">'</span><span class="rst-variable-string">numpy</span><span class="rst-variable-quote">'</span>)<br />
    <span class="py-keyword">def</span> <span class="py-defname">einsum</span><span class="function-signature">(*operands, out=<a href="https://docs.python.org/3/library/constants.html#None" class="intersphinx-link">None</a>, optimize=<a href="https://docs.python.org/3/library/constants.html#False" class="intersphinx-link">False</a>, **kwargs)</span>:
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L1009">
      
      (source)
    </a>
    <a class="headerLink" href="#einsum" title="numpy.core.einsumfunc.einsum">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p><dl class="rst-docutils">
<dt>einsum(subscripts, *operands, out=None, dtype=None, order='K',</dt>
<dd>casting='safe', optimize=False)</dd>
</dl>
<p>Evaluates the Einstein summation convention on the operands.</p>
<p>Using the Einstein summation convention, many common multi-dimensional,
linear algebraic array operations can be represented in a simple fashion.
In <em>implicit</em> mode <code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum" class="intersphinx-link">einsum</a></code> computes these values.</p>
<p>In <em>explicit</em> mode, <code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum" class="intersphinx-link">einsum</a></code> provides further flexibility to compute
other array operations that might not be considered classical Einstein
summation operations, by disabling, or forcing summation over specified
subscript labels.</p>
<p>See the notes and examples for clarification.</p>
<div class="rst-admonition seealso">
<p class="rst-first rst-admonition-title">See Also</p>
<p><code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum_path" class="intersphinx-link">einsum_path</a></code>, <code><a href="numpy.core.multiarray.html#dot" class="internal-link" title="numpy.core.multiarray.dot">dot</a></code>, <code><a href="numpy.core.multiarray.html#inner" class="internal-link" title="numpy.core.multiarray.inner">inner</a></code>, <code><a href="numpy.core.numeric.html#outer" class="internal-link" title="numpy.core.numeric.outer">outer</a></code>, <code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.numeric.html#tensordot" class="intersphinx-link">tensordot</a></code>, <code><a href="numpy.linalg.linalg.html#multi_dot" class="internal-link" title="numpy.linalg.linalg.multi_dot">linalg.multi_dot</a></code></p>
<dl class="rst-last rst-docutils">
<dt><code>einops</code></dt>
<dd>similar verbose interface is provided by <a class="rst-reference external" href="https://github.com/arogozhnikov/einops" target="_top">einops</a> package to cover additional operations: transpose, reshape/flatten, repeat/tile, squeeze/unsqueeze and reductions.</dd>
<dt><code>opt_einsum</code></dt>
<dd><a class="rst-reference external" href="https://optimized-einsum.readthedocs.io/en/stable/" target="_top">opt_einsum</a> optimizes contraction order for einsum-like expressions in backend-agnostic manner.</dd>
</dl>
</div>
<div class="rst-admonition rst-admonition-notes">
<p class="rst-first rst-admonition-title">Notes</p>
<div class="rst-versionadded">
<span class="rst-versionmodified rst-added">New in version 1.6.0.</span></div>
<p>The Einstein summation convention can be used to compute
many multi-dimensional, linear algebraic array operations. <code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum" class="intersphinx-link">einsum</a></code>
provides a succinct way of representing these.</p>
<p>A non-exhaustive list of these operations,
which can be computed by <code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum" class="intersphinx-link">einsum</a></code>, is shown below along with examples:</p>
<ul class="rst-simple">
<li>Trace of an array, <code>numpy.trace</code>.</li>
<li>Return a diagonal, <code>numpy.diag</code>.</li>
<li>Array axis summations, <code>numpy.sum</code>.</li>
<li>Transpositions and permutations, <code>numpy.transpose</code>.</li>
<li>Matrix multiplication and dot product, <code>numpy.matmul</code> <code>numpy.dot</code>.</li>
<li>Vector inner and outer products, <code>numpy.inner</code> <code>numpy.outer</code>.</li>
<li>Broadcasting, element-wise and scalar multiplication, <code>numpy.multiply</code>.</li>
<li>Tensor contractions, <code>numpy.tensordot</code>.</li>
<li>Chained array operations, in efficient calculation order, <code>numpy.einsum_path</code>.</li>
</ul>
<p>The subscripts string is a comma-separated list of subscript labels,
where each label refers to a dimension of the corresponding operand.
Whenever a label is repeated it is summed, so <tt class="rst-docutils literal"><span class="pre">np.einsum('i,i',</span> a, b)</tt>
is equivalent to <code>np.inner(a,b)</code>. If a label
appears only once, it is not summed, so <tt class="rst-docutils literal"><span class="pre">np.einsum('i',</span> a)</tt> produces a
view of <tt class="rst-docutils literal">a</tt> with no changes. A further example <tt class="rst-docutils literal"><span class="pre">np.einsum('ij,jk',</span> a, b)</tt>
describes traditional matrix multiplication and is equivalent to
<code>np.matmul(a,b)</code>. Repeated subscript labels in one
operand take the diagonal. For example, <tt class="rst-docutils literal"><span class="pre">np.einsum('ii',</span> a)</tt> is equivalent
to <code>np.trace(a)</code>.</p>
<p>In <em>implicit mode</em>, the chosen subscripts are important
since the axes of the output are reordered alphabetically.  This
means that <tt class="rst-docutils literal"><span class="pre">np.einsum('ij',</span> a)</tt> doesn't affect a 2D array, while
<tt class="rst-docutils literal"><span class="pre">np.einsum('ji',</span> a)</tt> takes its transpose. Additionally,
<tt class="rst-docutils literal"><span class="pre">np.einsum('ij,jk',</span> a, b)</tt> returns a matrix multiplication, while,
<tt class="rst-docutils literal"><span class="pre">np.einsum('ij,jh',</span> a, b)</tt> returns the transpose of the
multiplication since subscript 'h' precedes subscript 'i'.</p>
<p>In <em>explicit mode</em> the output can be directly controlled by
specifying output subscript labels.  This requires the
identifier '-&gt;' as well as the list of output subscript labels.
This feature increases the flexibility of the function since
summing can be disabled or forced when required. The call
<tt class="rst-docutils literal"><span class="pre">np.einsum('i-&gt;',</span> a)</tt> is like <code>np.sum(a, axis=-1)</code>,
and <tt class="rst-docutils literal"><span class="pre">np.einsum('ii-&gt;i',</span> a)</tt> is like <code>np.diag(a)</code>.
The difference is that <code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum" class="intersphinx-link">einsum</a></code> does not allow broadcasting by default.
Additionally <tt class="rst-docutils literal"><span class="pre">np.einsum('ij,jh-&gt;ih',</span> a, b)</tt> directly specifies the
order of the output subscript labels and therefore returns matrix
multiplication, unlike the example above in implicit mode.</p>
<p>To enable and control broadcasting, use an ellipsis.  Default
NumPy-style broadcasting is done by adding an ellipsis
to the left of each term, like <tt class="rst-docutils literal"><span class="pre">np.einsum('...ii-&gt;...i',</span> a)</tt>.
To take the trace along the first and last axes,
you can do <tt class="rst-docutils literal"><span class="pre">np.einsum('i...i',</span> a)</tt>, or to do a matrix-matrix
product with the left-most indices instead of rightmost, one can do
<tt class="rst-docutils literal"><span class="pre">np.einsum('ij...,jk...-&gt;ik...',</span> a, b)</tt>.</p>
<p>When there is only one operand, no axes are summed, and no output
parameter is provided, a view into the operand is returned instead
of a new array.  Thus, taking the diagonal as <tt class="rst-docutils literal"><span class="pre">np.einsum('ii-&gt;i',</span> a)</tt>
produces a view (changed in version 1.10.0).</p>
<p><code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum" class="intersphinx-link">einsum</a></code> also provides an alternative way to provide the subscripts
and operands as <tt class="rst-docutils literal">einsum(op0, sublist0, op1, sublist1, <span class="pre">...,</span> [sublistout])</tt>.
If the output shape is not provided in this format <code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum" class="intersphinx-link">einsum</a></code> will be
calculated in implicit mode, otherwise it will be performed explicitly.
The examples below have corresponding <code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum" class="intersphinx-link">einsum</a></code> calls with the two
parameter methods.</p>
<div class="rst-versionadded">
<span class="rst-versionmodified rst-added">New in version 1.10.0.</span></div>
<p>Views returned from einsum are now writeable whenever the input array
is writeable. For example, <tt class="rst-docutils literal"><span class="pre">np.einsum('ijk...-&gt;kji...',</span> a)</tt> will now
have the same effect as <code>np.swapaxes(a, 0, 2)</code>
and <tt class="rst-docutils literal"><span class="pre">np.einsum('ii-&gt;i',</span> a)</tt> will return a writeable view of the diagonal
of a 2D array.</p>
<div class="rst-versionadded">
<span class="rst-versionmodified rst-added">New in version 1.12.0.</span></div>
<p>Added the <tt class="rst-docutils literal">optimize</tt> argument which will optimize the contraction order
of an einsum expression. For a contraction with three or more operands this
can greatly increase the computational efficiency at the cost of a larger
memory footprint during computation.</p>
<p>Typically a 'greedy' algorithm is applied which empirical tests have shown
returns the optimal path in the majority of cases. In some cases 'optimal'
will return the superlative path through a more expensive, exhaustive search.
For iterative calculations it may be advisable to calculate the optimal path
once and reuse that path by supplying it as an argument. An example is given
below.</p>
<p class="rst-last">See <code>numpy.einsum_path</code> for more details.</p>
</div>
<div class="rst-admonition rst-admonition-examples">
<p class="rst-first rst-admonition-title">Examples</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>a = np.arange(25).reshape(5,5)
<span class="py-prompt">&gt;&gt;&gt; </span>b = np.arange(5)
<span class="py-prompt">&gt;&gt;&gt; </span>c = np.arange(6).reshape(2,3)</pre><p>Trace of a matrix:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'ii'</span>, a)
<span class="py-output">60</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(a, [0,0])
<span class="py-output">60</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.trace(a)
<span class="py-output">60</span>
</pre><p>Extract the diagonal (requires explicit form):</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'ii-&gt;i'</span>, a)
<span class="py-output">array([ 0,  6, 12, 18, 24])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(a, [0,0], [0])
<span class="py-output">array([ 0,  6, 12, 18, 24])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.diag(a)
<span class="py-output">array([ 0,  6, 12, 18, 24])</span>
</pre><p>Sum over an axis (requires explicit form):</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'ij-&gt;i'</span>, a)
<span class="py-output">array([ 10,  35,  60,  85, 110])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(a, [0,1], [0])
<span class="py-output">array([ 10,  35,  60,  85, 110])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.sum(a, axis=1)
<span class="py-output">array([ 10,  35,  60,  85, 110])</span>
</pre><p>For higher dimensional arrays summing a single axis can be done with ellipsis:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'...j-&gt;...'</span>, a)
<span class="py-output">array([ 10,  35,  60,  85, 110])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(a, [<span class="py-builtin">Ellipsis</span>,1], [<span class="py-builtin">Ellipsis</span>])
<span class="py-output">array([ 10,  35,  60,  85, 110])</span>
</pre><p>Compute a matrix transpose, or reorder any number of axes:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'ji'</span>, c)
<span class="py-output">array([[0, 3],</span>
<span class="py-output">       [1, 4],</span>
<span class="py-output">       [2, 5]])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'ij-&gt;ji'</span>, c)
<span class="py-output">array([[0, 3],</span>
<span class="py-output">       [1, 4],</span>
<span class="py-output">       [2, 5]])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(c, [1,0])
<span class="py-output">array([[0, 3],</span>
<span class="py-output">       [1, 4],</span>
<span class="py-output">       [2, 5]])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.transpose(c)
<span class="py-output">array([[0, 3],</span>
<span class="py-output">       [1, 4],</span>
<span class="py-output">       [2, 5]])</span>
</pre><p>Vector inner products:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'i,i'</span>, b, b)
<span class="py-output">30</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(b, [0], b, [0])
<span class="py-output">30</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.inner(b,b)
<span class="py-output">30</span>
</pre><p>Matrix vector multiplication:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'ij,j'</span>, a, b)
<span class="py-output">array([ 30,  80, 130, 180, 230])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(a, [0,1], b, [1])
<span class="py-output">array([ 30,  80, 130, 180, 230])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.dot(a, b)
<span class="py-output">array([ 30,  80, 130, 180, 230])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'...j,j'</span>, a, b)
<span class="py-output">array([ 30,  80, 130, 180, 230])</span>
</pre><p>Broadcasting and scalar multiplication:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'..., ...'</span>, 3, c)
<span class="py-output">array([[ 0,  3,  6],</span>
<span class="py-output">       [ 9, 12, 15]])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">',ij'</span>, 3, c)
<span class="py-output">array([[ 0,  3,  6],</span>
<span class="py-output">       [ 9, 12, 15]])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(3, [<span class="py-builtin">Ellipsis</span>], c, [<span class="py-builtin">Ellipsis</span>])
<span class="py-output">array([[ 0,  3,  6],</span>
<span class="py-output">       [ 9, 12, 15]])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.multiply(3, c)
<span class="py-output">array([[ 0,  3,  6],</span>
<span class="py-output">       [ 9, 12, 15]])</span>
</pre><p>Vector outer product:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'i,j'</span>, np.arange(2)+1, b)
<span class="py-output">array([[0, 1, 2, 3, 4],</span>
<span class="py-output">       [0, 2, 4, 6, 8]])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(np.arange(2)+1, [0], b, [1])
<span class="py-output">array([[0, 1, 2, 3, 4],</span>
<span class="py-output">       [0, 2, 4, 6, 8]])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.outer(np.arange(2)+1, b)
<span class="py-output">array([[0, 1, 2, 3, 4],</span>
<span class="py-output">       [0, 2, 4, 6, 8]])</span>
</pre><p>Tensor contraction:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>a = np.arange(60.).reshape(3,4,5)
<span class="py-prompt">&gt;&gt;&gt; </span>b = np.arange(24.).reshape(4,3,2)
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'ijk,jil-&gt;kl'</span>, a, b)
<span class="py-output">array([[4400., 4730.],</span>
<span class="py-output">       [4532., 4874.],</span>
<span class="py-output">       [4664., 5018.],</span>
<span class="py-output">       [4796., 5162.],</span>
<span class="py-output">       [4928., 5306.]])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(a, [0,1,2], b, [1,0,3], [2,3])
<span class="py-output">array([[4400., 4730.],</span>
<span class="py-output">       [4532., 4874.],</span>
<span class="py-output">       [4664., 5018.],</span>
<span class="py-output">       [4796., 5162.],</span>
<span class="py-output">       [4928., 5306.]])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.tensordot(a,b, axes=([1,0],[0,1]))
<span class="py-output">array([[4400., 4730.],</span>
<span class="py-output">       [4532., 4874.],</span>
<span class="py-output">       [4664., 5018.],</span>
<span class="py-output">       [4796., 5162.],</span>
<span class="py-output">       [4928., 5306.]])</span>
</pre><p>Writeable returned arrays (since version 1.10.0):</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>a = np.zeros((3, 3))
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'ii-&gt;i'</span>, a)[:] = 1
<span class="py-prompt">&gt;&gt;&gt; </span>a
<span class="py-output">array([[1., 0., 0.],</span>
<span class="py-output">       [0., 1., 0.],</span>
<span class="py-output">       [0., 0., 1.]])</span>
</pre><p>Example of ellipsis use:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>a = np.arange(6).reshape((3,2))
<span class="py-prompt">&gt;&gt;&gt; </span>b = np.arange(12).reshape((4,3))
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'ki,jk-&gt;ij'</span>, a, b)
<span class="py-output">array([[10, 28, 46, 64],</span>
<span class="py-output">       [13, 40, 67, 94]])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'ki,...k-&gt;i...'</span>, a, b)
<span class="py-output">array([[10, 28, 46, 64],</span>
<span class="py-output">       [13, 40, 67, 94]])</span>
<span class="py-prompt">&gt;&gt;&gt; </span>np.einsum(<span class="py-string">'k...,jk'</span>, a, b)
<span class="py-output">array([[10, 28, 46, 64],</span>
<span class="py-output">       [13, 40, 67, 94]])</span>
</pre><p>Chained array operations. For more complicated contractions, speed ups
might be achieved by repeatedly computing a 'greedy' path or pre-computing the
'optimal' path and repeatedly applying it, using an
<code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum_path" class="intersphinx-link">einsum_path</a></code> insertion (since version 1.12.0). Performance improvements can be
particularly significant with larger arrays:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>a = np.ones(64).reshape(2,4,8)</pre><p>Basic <code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum" class="intersphinx-link">einsum</a></code>: ~1520ms  (benchmarked on 3.1GHz Intel i5.)</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> iteration <span class="py-keyword">in</span> <span class="py-builtin">range</span>(500):
<span class="py-more">... </span>    _ = np.einsum(<span class="py-string">'ijk,ilm,njm,nlk,abc-&gt;'</span>,a,a,a,a,a)</pre><p>Sub-optimal <code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum" class="intersphinx-link">einsum</a></code> (due to repeated path calculation time): ~330ms</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> iteration <span class="py-keyword">in</span> <span class="py-builtin">range</span>(500):
<span class="py-more">... </span>    _ = np.einsum(<span class="py-string">'ijk,ilm,njm,nlk,abc-&gt;'</span>,a,a,a,a,a, optimize=<span class="py-string">'optimal'</span>)</pre><p>Greedy <code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum" class="intersphinx-link">einsum</a></code> (faster optimal path approximation): ~160ms</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> iteration <span class="py-keyword">in</span> <span class="py-builtin">range</span>(500):
<span class="py-more">... </span>    _ = np.einsum(<span class="py-string">'ijk,ilm,njm,nlk,abc-&gt;'</span>,a,a,a,a,a, optimize=<span class="py-string">'greedy'</span>)</pre><p>Optimal <code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum" class="intersphinx-link">einsum</a></code> (best usage pattern in some use cases): ~110ms</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>path = np.einsum_path(<span class="py-string">'ijk,ilm,njm,nlk,abc-&gt;'</span>,a,a,a,a,a, optimize=<span class="py-string">'optimal'</span>)[0]
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> iteration <span class="py-keyword">in</span> <span class="py-builtin">range</span>(500):
<span class="py-more">... </span>    _ = np.einsum(<span class="py-string">'ijk,ilm,njm,nlk,abc-&gt;'</span>,a,a,a,a,a, optimize=path)</pre></div>
</p><table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">*operands:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code> of <code>array_like</code></td><td class="fieldArgDesc">These are the arrays for the operation.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">out:</span><code>ndarray</code>, <em>optional</em></td><td class="fieldArgDesc">If provided, the calculation is done into this array.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">optimize:</span><span class="literal">{False</span>, <code><a href="https://docs.python.org/3/library/constants.html#True" class="intersphinx-link">True</a></code>, <span class="literal">'greedy'</span>, <span class="literal">'optimal'</span><span class="literal">}</span>, <em>optional</em></td><td class="fieldArgDesc">Controls if intermediate optimization should occur. No optimization
will occur if False and True will default to the 'greedy' algorithm.
Also accepts an explicit contraction list from the <tt class="rst-docutils literal">np.einsum_path</tt>
function. See <tt class="rst-docutils literal">np.einsum_path</tt> for more details. Defaults to False.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">**kwargs</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">subscripts:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#str" class="intersphinx-link">str</a></code></td><td class="fieldArgDesc">Specifies the subscripts for summation as comma separated list of
subscript labels. An implicit (classical Einstein summation)
calculation is performed unless the explicit indicator '-&gt;' is
included as well as subscript labels of the precise output form.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">dtype:</span><span class="literal">{data-type</span>, <span class="literal">None}</span>, <em>optional</em></td><td class="fieldArgDesc">If provided, forces the calculation to use the data type specified.
Note that you may have to also give a more liberal <code>casting</code>
parameter to allow the conversions. Default is None.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">order:</span><span class="literal">{'C', 'F', 'A', 'K'}</span>, <em>optional</em></td><td class="fieldArgDesc">Controls the memory layout of the output. 'C' means it should
be C contiguous. 'F' means it should be Fortran contiguous,
'A' means it should be 'F' if the inputs are all 'F', 'C' otherwise.
'K' means it should be as close to the layout as the inputs as
is possible, including arbitrarily permuted axes.
Default is 'K'.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">casting:</span><span class="literal">{'no', 'equiv', 'safe', 'same_kind', 'unsafe'}</span>, <em>optional</em></td><td class="fieldArgDesc"><p>Controls what kind of data casting may occur.  Setting this to
'unsafe' is not recommended, as it can adversely affect accumulations.</p>
<blockquote>
<ul class="rst-simple">
<li>'no' means the data types should not be cast at all.</li>
<li>'equiv' means only byte-order changes are allowed.</li>
<li>'safe' means only casts which can preserve values are allowed.</li>
<li>'same_kind' means only safe casts or casts within a kind,
like float64 to float32, are allowed.</li>
<li>'unsafe' means any data conversions may be done.</li>
</ul>
</blockquote>
<p>Default is 'safe'.</p>
</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code>ndarray</code></td><td class="fieldArgDesc"><strong>output</strong> - The calculation based on the Einstein summation convention.</td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="numpy.core.einsumfunc.einsum_path">
    
  </a>
  <a name="einsum_path">
    
  </a>
  <div class="functionHeader">
    
    @<a href="numpy.core.overrides.html#array_function_dispatch" class="internal-link" title="numpy.core.overrides.array_function_dispatch">array_function_dispatch</a>(<wbr></wbr><a href="#_einsum_path_dispatcher" class="internal-link" title="numpy.core.einsumfunc._einsum_path_dispatcher">_einsum_path_dispatcher</a>, <wbr></wbr>module=<span class="rst-variable-quote">'</span><span class="rst-variable-string">numpy</span><span class="rst-variable-quote">'</span>)<br />
    <span class="py-keyword">def</span> <span class="py-defname">einsum_path</span><span class="function-signature">(*operands, optimize=<span class="rst-variable-quote">'</span><span class="rst-variable-string">greedy</span><span class="rst-variable-quote">'</span>, einsum_call=<a href="https://docs.python.org/3/library/constants.html#False" class="intersphinx-link">False</a>)</span>:
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L706">
      
      (source)
    </a>
    <a class="headerLink" href="#einsum_path" title="numpy.core.einsumfunc.einsum_path">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>einsum_path(subscripts, *operands, optimize='greedy')</p>
<p>Evaluates the lowest cost contraction order for an einsum expression by
considering the creation of intermediate arrays.</p>
<div class="rst-admonition rst-admonition-notes">
<p class="rst-first rst-admonition-title">Notes</p>
<p class="rst-last">The resulting path indicates which terms of the input contraction should be
contracted first, the result of this contraction is then appended to the
end of the contraction list. This list can then be iterated over until all
intermediate contractions are complete.</p>
</div>
<div class="rst-admonition seealso">
<p class="rst-first rst-admonition-title">See Also</p>
<p class="rst-last"><code><a href="https://pydocbrowser.github.io/numpy/latest/numpy.core.einsumfunc.html#einsum" class="intersphinx-link">einsum</a></code>, <code><a href="numpy.linalg.linalg.html#multi_dot" class="internal-link" title="numpy.linalg.linalg.multi_dot">linalg.multi_dot</a></code></p>
</div>
<div class="rst-admonition rst-admonition-examples">
<p class="rst-first rst-admonition-title">Examples</p>
<p>We can begin with a chain dot example. In this case, it is optimal to
contract the <tt class="rst-docutils literal">b</tt> and <tt class="rst-docutils literal">c</tt> tensors first as represented by the first
element of the path <tt class="rst-docutils literal">(1, 2)</tt>. The resulting tensor is added to the end
of the contraction and the remaining contraction <tt class="rst-docutils literal">(0, 1)</tt> is then
completed.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>np.random.seed(123)
<span class="py-prompt">&gt;&gt;&gt; </span>a = np.random.rand(2, 2)
<span class="py-prompt">&gt;&gt;&gt; </span>b = np.random.rand(2, 5)
<span class="py-prompt">&gt;&gt;&gt; </span>c = np.random.rand(5, 2)
<span class="py-prompt">&gt;&gt;&gt; </span>path_info = np.einsum_path(<span class="py-string">'ij,jk,kl-&gt;il'</span>, a, b, c, optimize=<span class="py-string">'greedy'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-builtin">print</span>(path_info[0])
<span class="py-output">['einsum_path', (1, 2), (0, 1)]</span>
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-builtin">print</span>(path_info[1])
<span class="py-output">  Complete contraction:  ij,jk,kl-&gt;il # may vary</span>
<span class="py-output">         Naive scaling:  4</span>
<span class="py-output">     Optimized scaling:  3</span>
<span class="py-output">      Naive FLOP count:  1.600e+02</span>
<span class="py-output">  Optimized FLOP count:  5.600e+01</span>
<span class="py-output">   Theoretical speedup:  2.857</span>
<span class="py-output">  Largest intermediate:  4.000e+00 elements</span>
<span class="py-output">-------------------------------------------------------------------------</span>
<span class="py-output">scaling                  current                                remaining</span>
<span class="py-output">-------------------------------------------------------------------------</span>
<span class="py-output">   3                   kl,jk-&gt;jl                                ij,jl-&gt;il</span>
<span class="py-output">   3                   jl,ij-&gt;il                                   il-&gt;il</span>
</pre></div>
<p>A more complex index transformation example.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>I = np.random.rand(10, 10, 10, 10)
<span class="py-prompt">&gt;&gt;&gt; </span>C = np.random.rand(10, 10)
<span class="py-prompt">&gt;&gt;&gt; </span>path_info = np.einsum_path(<span class="py-string">'ea,fb,abcd,gc,hd-&gt;efgh'</span>, C, C, I, C, C,
<span class="py-more">... </span>                           optimize=<span class="py-string">'greedy'</span>)</pre><pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-builtin">print</span>(path_info[0])
<span class="py-output">['einsum_path', (0, 2), (0, 3), (0, 2), (0, 1)]</span>
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-builtin">print</span>(path_info[1])
<span class="py-output">  Complete contraction:  ea,fb,abcd,gc,hd-&gt;efgh # may vary</span>
<span class="py-output">         Naive scaling:  8</span>
<span class="py-output">     Optimized scaling:  5</span>
<span class="py-output">      Naive FLOP count:  8.000e+08</span>
<span class="py-output">  Optimized FLOP count:  8.000e+05</span>
<span class="py-output">   Theoretical speedup:  1000.000</span>
<span class="py-output">  Largest intermediate:  1.000e+04 elements</span>
<span class="py-output">--------------------------------------------------------------------------</span>
<span class="py-output">scaling                  current                                remaining</span>
<span class="py-output">--------------------------------------------------------------------------</span>
<span class="py-output">   5               abcd,ea-&gt;bcde                      fb,gc,hd,bcde-&gt;efgh</span>
<span class="py-output">   5               bcde,fb-&gt;cdef                         gc,hd,cdef-&gt;efgh</span>
<span class="py-output">   5               cdef,gc-&gt;defg                            hd,defg-&gt;efgh</span>
<span class="py-output">   5               defg,hd-&gt;efgh                               efgh-&gt;efgh</span>
</pre><table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">*operands:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code> of <code>array_like</code></td><td class="fieldArgDesc">These are the arrays for the operation.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">optimize:</span><span class="literal">{bool</span>, <code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code>, <code><a href="https://docs.python.org/3/library/stdtypes.html#tuple" class="intersphinx-link">tuple</a></code>, <span class="literal">'greedy'</span>, <span class="literal">'optimal'</span><span class="literal">}</span></td><td class="fieldArgDesc"><p>Choose the type of path. If a tuple is provided, the second argument is
assumed to be the maximum intermediate size created. If only a single
argument is provided the largest input or output array size is used
as a maximum intermediate size.</p>
<ul class="rst-simple">
<li>if a list is given that starts with <tt class="rst-docutils literal">einsum_path</tt>, uses this as the
contraction path</li>
<li>if False no optimization is taken</li>
<li>if True defaults to the 'greedy' algorithm</li>
<li>'optimal' An algorithm that combinatorially explores all possible
ways of contracting the listed tensors and choosest the least costly
path. Scales exponentially with the number of terms in the
contraction.</li>
<li>'greedy' An algorithm that chooses the best pair contraction
at each step. Effectively, this algorithm searches the largest inner,
Hadamard, and then outer products at each step. Scales cubically with
the number of terms in the contraction. Equivalent to the 'optimal'
path for most contractions.</li>
</ul>
<p>Default is 'greedy'.</p>
</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">einsum<wbr></wbr>_call</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">subscripts:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#str" class="intersphinx-link">str</a></code></td><td class="fieldArgDesc">Specifies the subscripts for summation.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td colspan="2"><ul class="rst-simple">
<li><strong>path</strong>: <code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code> of <code>tuples</code> - A list representation of the einsum path.</li>
<li><strong>string_repr</strong>: <code><a href="https://docs.python.org/3/library/stdtypes.html#str" class="intersphinx-link">str</a></code> - A printable representation of the einsum path.</li>
</ul>
</td></tr></table></div>
  </div>
</div><div class="basevariable">
  
  
  <a name="numpy.core.einsumfunc.einsum_symbols">
    
  </a>
  <a name="einsum_symbols">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">einsum_symbols</span>: <code><a href="https://docs.python.org/3/library/stdtypes.html#str" class="intersphinx-link">str</a></code> =
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L14">
      
      (source)
    </a>
    <a class="headerLink" href="#einsum_symbols" title="numpy.core.einsumfunc.einsum_symbols">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="basevariable">
  
  
  <a name="numpy.core.einsumfunc.einsum_symbols_set">
    
  </a>
  <a name="einsum_symbols_set">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">einsum_symbols_set</span> =
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L15">
      
      (source)
    </a>
    <a class="headerLink" href="#einsum_symbols_set" title="numpy.core.einsumfunc.einsum_symbols_set">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="basefunction private">
  
  
  <a name="numpy.core.einsumfunc._can_dot">
    
  </a>
  <a name="_can_dot">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_can_dot</span><span class="function-signature">(inputs, result, idx_removed)</span>:
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L413">
      
      (source)
    </a>
    <a class="headerLink" href="#_can_dot" title="numpy.core.einsumfunc._can_dot">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Checks if we can use BLAS (np.tensordot) call and its beneficial to do so.</p>
<div class="rst-admonition rst-admonition-notes">
<p class="rst-first rst-admonition-title">Notes</p>
<p class="rst-last">If the operations is BLAS level 1 or 2 and is not already aligned
we default back to einsum as the memory movement to copy is more
costly than the operation itself.</p>
</div>
<div class="rst-admonition rst-admonition-examples">
<p class="rst-first rst-admonition-title">Examples</p>
<p># Standard GEMM operation
&gt;&gt;&gt; _can_dot(['ij', 'jk'], 'ik', set('j'))
True</p>
<p># Can use the standard BLAS, but requires odd data movement
&gt;&gt;&gt; _can_dot(['ijj', 'jk'], 'ik', set('j'))
False</p>
<p class="rst-last"># DDOT where the memory is not aligned
&gt;&gt;&gt; _can_dot(['ijk', 'ikj'], '', set('ijk'))
False</p>
</div>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">inputs:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code> of <code><a href="https://docs.python.org/3/library/stdtypes.html#str" class="intersphinx-link">str</a></code></td><td class="fieldArgDesc">Specifies the subscripts for summation.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">result:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#str" class="intersphinx-link">str</a></code></td><td class="fieldArgDesc">Resulting summation.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">idx<wbr></wbr>_removed:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#set" class="intersphinx-link">set</a></code></td><td class="fieldArgDesc">Indices that are removed in the summation</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code><a href="https://docs.python.org/3/library/functions.html#bool" class="intersphinx-link">bool</a></code></td><td class="fieldArgDesc"><strong>type</strong> - Returns true if BLAS should and can be used, else False</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="numpy.core.einsumfunc._compute_size_by_dict">
    
  </a>
  <a name="_compute_size_by_dict">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_compute_size_by_dict</span><span class="function-signature">(indices, idx_dict)</span>:
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L56">
      
      (source)
    </a>
    <a class="headerLink" href="#_compute_size_by_dict" title="numpy.core.einsumfunc._compute_size_by_dict">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Computes the product of the elements in indices based on the dictionary
idx_dict.</p>
<div class="rst-admonition rst-admonition-examples">
<p class="rst-first rst-admonition-title">Examples</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>_compute_size_by_dict(<span class="py-string">'abbc'</span>, {<span class="py-string">'a'</span>: 2, <span class="py-string">'b'</span>:3, <span class="py-string">'c'</span>:5})
<span class="py-output">90</span>
</pre></div>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">indices:</span><code><a href="numpy.lib.function_base.html#iterable" class="internal-link" title="numpy.lib.function_base.iterable">iterable</a></code></td><td class="fieldArgDesc">Indices to base the product on.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">idx<wbr></wbr>_dict:</span><code>dictionary</code></td><td class="fieldArgDesc">Dictionary of index sizes</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code><a href="https://docs.python.org/3/library/functions.html#int" class="intersphinx-link">int</a></code></td><td class="fieldArgDesc"><strong>ret</strong> - The resulting product.</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="numpy.core.einsumfunc._einsum_dispatcher">
    
  </a>
  <a name="_einsum_dispatcher">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_einsum_dispatcher</span><span class="function-signature">(*operands, out=<a href="https://docs.python.org/3/library/constants.html#None" class="intersphinx-link">None</a>, optimize=<a href="https://docs.python.org/3/library/constants.html#None" class="intersphinx-link">None</a>, **kwargs)</span>:
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L1001">
      
      (source)
    </a>
    <a class="headerLink" href="#_einsum_dispatcher" title="numpy.core.einsumfunc._einsum_dispatcher">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="undocumented">Undocumented</p></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="numpy.core.einsumfunc._einsum_path_dispatcher">
    
  </a>
  <a name="_einsum_path_dispatcher">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_einsum_path_dispatcher</span><span class="function-signature">(*operands, optimize=<a href="https://docs.python.org/3/library/constants.html#None" class="intersphinx-link">None</a>, einsum_call=<a href="https://docs.python.org/3/library/constants.html#None" class="intersphinx-link">None</a>)</span>:
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L696">
      
      (source)
    </a>
    <a class="headerLink" href="#_einsum_path_dispatcher" title="numpy.core.einsumfunc._einsum_path_dispatcher">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="undocumented">Undocumented</p></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="numpy.core.einsumfunc._find_contraction">
    
  </a>
  <a name="_find_contraction">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_find_contraction</span><span class="function-signature">(positions, input_sets, output_set)</span>:
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L85">
      
      (source)
    </a>
    <a class="headerLink" href="#_find_contraction" title="numpy.core.einsumfunc._find_contraction">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Finds the contraction for a given set of input and output sets.</p>
<div class="rst-admonition rst-admonition-examples">
<p class="rst-first rst-admonition-title">Examples</p>
<p># A simple dot product test case
&gt;&gt;&gt; pos = (0, 1)
&gt;&gt;&gt; isets = [set('ab'), set('bc')]
&gt;&gt;&gt; oset = set('ac')
&gt;&gt;&gt; _find_contraction(pos, isets, oset)
({'a', 'c'}, [{'a', 'c'}], {'b'}, {'a', 'b', 'c'})</p>
<p class="rst-last"># A more complex case with additional terms in the contraction
&gt;&gt;&gt; pos = (0, 2)
&gt;&gt;&gt; isets = [set('abd'), set('ac'), set('bdc')]
&gt;&gt;&gt; oset = set('ac')
&gt;&gt;&gt; _find_contraction(pos, isets, oset)
({'a', 'c'}, [{'a', 'c'}, {'a', 'c'}], {'b', 'd'}, {'a', 'b', 'c', 'd'})</p>
</div>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">positions:</span><code><a href="numpy.lib.function_base.html#iterable" class="internal-link" title="numpy.lib.function_base.iterable">iterable</a></code></td><td class="fieldArgDesc">Integer positions of terms used in the contraction.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">input<wbr></wbr>_sets:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code></td><td class="fieldArgDesc">List of sets that represent the lhs side of the einsum subscript</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">output<wbr></wbr>_set:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#set" class="intersphinx-link">set</a></code></td><td class="fieldArgDesc">Set that represents the rhs side of the overall einsum subscript</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td colspan="2"><ul class="rst-simple">
<li><strong>new_result</strong>: <code><a href="https://docs.python.org/3/library/stdtypes.html#set" class="intersphinx-link">set</a></code> - The indices of the resulting contraction</li>
<li><strong>remaining</strong>: <code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code> - List of sets that have not been contracted, the new set is appended to
the end of this list</li>
<li><strong>idx_removed</strong>: <code><a href="https://docs.python.org/3/library/stdtypes.html#set" class="intersphinx-link">set</a></code> - Indices removed from the entire contraction</li>
<li><strong>idx_contraction</strong>: <code><a href="https://docs.python.org/3/library/stdtypes.html#set" class="intersphinx-link">set</a></code> - The indices used in the current contraction</li>
</ul>
</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="numpy.core.einsumfunc._flop_count">
    
  </a>
  <a name="_flop_count">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_flop_count</span><span class="function-signature">(idx_contraction, inner, num_terms, size_dictionary)</span>:
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L18">
      
      (source)
    </a>
    <a class="headerLink" href="#_flop_count" title="numpy.core.einsumfunc._flop_count">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Computes the number of FLOPS in the contraction.</p>
<div class="rst-admonition rst-admonition-examples">
<p class="rst-first rst-admonition-title">Examples</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>_flop_count(<span class="py-string">'abc'</span>, <span class="py-builtin">False</span>, 1, {<span class="py-string">'a'</span>: 2, <span class="py-string">'b'</span>:3, <span class="py-string">'c'</span>:5})
<span class="py-output">30</span>
</pre><pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>_flop_count(<span class="py-string">'abc'</span>, <span class="py-builtin">True</span>, 2, {<span class="py-string">'a'</span>: 2, <span class="py-string">'b'</span>:3, <span class="py-string">'c'</span>:5})
<span class="py-output">60</span>
</pre></div>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">idx<wbr></wbr>_contraction:</span><code><a href="numpy.lib.function_base.html#iterable" class="internal-link" title="numpy.lib.function_base.iterable">iterable</a></code></td><td class="fieldArgDesc">The indices involved in the contraction</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">inner:</span><code><a href="https://docs.python.org/3/library/functions.html#bool" class="intersphinx-link">bool</a></code></td><td class="fieldArgDesc">Does this contraction require an inner product?</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">num<wbr></wbr>_terms:</span><code><a href="https://docs.python.org/3/library/functions.html#int" class="intersphinx-link">int</a></code></td><td class="fieldArgDesc">The number of terms in a contraction</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">size<wbr></wbr>_dictionary:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#dict" class="intersphinx-link">dict</a></code></td><td class="fieldArgDesc">The size of each of the indices in idx_contraction</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code><a href="https://docs.python.org/3/library/functions.html#int" class="intersphinx-link">int</a></code></td><td class="fieldArgDesc"><strong>flop_count</strong> - The total number of FLOPS required for the contraction.</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="numpy.core.einsumfunc._greedy_path">
    
  </a>
  <a name="_greedy_path">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_greedy_path</span><span class="function-signature">(input_sets, output_set, idx_dict, memory_limit)</span>:
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L312">
      
      (source)
    </a>
    <a class="headerLink" href="#_greedy_path" title="numpy.core.einsumfunc._greedy_path">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Finds the path by contracting the best pair until the input list is
exhausted. The best pair is found by minimizing the tuple
<tt class="rst-docutils literal"><span class="pre">(-prod(indices_removed),</span> cost)</tt>.  What this amounts to is prioritizing
matrix multiplication or inner product operations, then Hadamard like
operations, and finally outer operations. Outer products are limited by
<tt class="rst-docutils literal">memory_limit</tt>. This algorithm scales cubically with respect to the
number of elements in the list <tt class="rst-docutils literal">input_sets</tt>.</p>
<div class="rst-admonition rst-admonition-examples">
<p class="rst-first rst-admonition-title">Examples</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>isets = [<span class="py-builtin">set</span>(<span class="py-string">'abd'</span>), <span class="py-builtin">set</span>(<span class="py-string">'ac'</span>), <span class="py-builtin">set</span>(<span class="py-string">'bdc'</span>)]
<span class="py-prompt">&gt;&gt;&gt; </span>oset = <span class="py-builtin">set</span>()
<span class="py-prompt">&gt;&gt;&gt; </span>idx_sizes = {<span class="py-string">'a'</span>: 1, <span class="py-string">'b'</span>:2, <span class="py-string">'c'</span>:3, <span class="py-string">'d'</span>:4}
<span class="py-prompt">&gt;&gt;&gt; </span>_greedy_path(isets, oset, idx_sizes, 5000)
<span class="py-output">[(0, 2), (0, 1)]</span>
</pre></div>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">input<wbr></wbr>_sets:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code></td><td class="fieldArgDesc">List of sets that represent the lhs side of the einsum subscript</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">output<wbr></wbr>_set:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#set" class="intersphinx-link">set</a></code></td><td class="fieldArgDesc">Set that represents the rhs side of the overall einsum subscript</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">idx<wbr></wbr>_dict:</span><code>dictionary</code></td><td class="fieldArgDesc">Dictionary of index sizes</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">memory<wbr></wbr>_limit:</span><code><a href="https://docs.python.org/3/library/functions.html#int" class="intersphinx-link">int</a></code></td><td class="fieldArgDesc">The maximum number of elements in a temporary array</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code></td><td class="fieldArgDesc"><strong>path</strong> - The greedy contraction order within the memory limit constraint.</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="numpy.core.einsumfunc._optimal_path">
    
  </a>
  <a name="_optimal_path">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_optimal_path</span><span class="function-signature">(input_sets, output_set, idx_dict, memory_limit)</span>:
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L145">
      
      (source)
    </a>
    <a class="headerLink" href="#_optimal_path" title="numpy.core.einsumfunc._optimal_path">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Computes all possible pair contractions, sieves the results based
on <tt class="rst-docutils literal">memory_limit</tt> and returns the lowest cost path. This algorithm
scales factorial with respect to the elements in the list <tt class="rst-docutils literal">input_sets</tt>.</p>
<div class="rst-admonition rst-admonition-examples">
<p class="rst-first rst-admonition-title">Examples</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>isets = [<span class="py-builtin">set</span>(<span class="py-string">'abd'</span>), <span class="py-builtin">set</span>(<span class="py-string">'ac'</span>), <span class="py-builtin">set</span>(<span class="py-string">'bdc'</span>)]
<span class="py-prompt">&gt;&gt;&gt; </span>oset = <span class="py-builtin">set</span>()
<span class="py-prompt">&gt;&gt;&gt; </span>idx_sizes = {<span class="py-string">'a'</span>: 1, <span class="py-string">'b'</span>:2, <span class="py-string">'c'</span>:3, <span class="py-string">'d'</span>:4}
<span class="py-prompt">&gt;&gt;&gt; </span>_optimal_path(isets, oset, idx_sizes, 5000)
<span class="py-output">[(0, 2), (0, 1)]</span>
</pre></div>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">input<wbr></wbr>_sets:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code></td><td class="fieldArgDesc">List of sets that represent the lhs side of the einsum subscript</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">output<wbr></wbr>_set:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#set" class="intersphinx-link">set</a></code></td><td class="fieldArgDesc">Set that represents the rhs side of the overall einsum subscript</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">idx<wbr></wbr>_dict:</span><code>dictionary</code></td><td class="fieldArgDesc">Dictionary of index sizes</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">memory<wbr></wbr>_limit:</span><code><a href="https://docs.python.org/3/library/functions.html#int" class="intersphinx-link">int</a></code></td><td class="fieldArgDesc">The maximum number of elements in a temporary array</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code></td><td class="fieldArgDesc"><strong>path</strong> - The optimal contraction order within the memory limit constraint.</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="numpy.core.einsumfunc._parse_einsum_input">
    
  </a>
  <a name="_parse_einsum_input">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_parse_einsum_input</span><span class="function-signature">(operands)</span>:
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L523">
      
      (source)
    </a>
    <a class="headerLink" href="#_parse_einsum_input" title="numpy.core.einsumfunc._parse_einsum_input">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>A reproduction of einsum c side einsum parsing in python.</p>
<div class="rst-admonition rst-admonition-examples">
<p class="rst-first rst-admonition-title">Examples</p>
<p>The operand list is simplified to reduce printing:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>np.random.seed(123)
<span class="py-prompt">&gt;&gt;&gt; </span>a = np.random.rand(4, 4)
<span class="py-prompt">&gt;&gt;&gt; </span>b = np.random.rand(4, 4, 4)
<span class="py-prompt">&gt;&gt;&gt; </span>_parse_einsum_input((<span class="py-string">'...a,...a-&gt;...'</span>, a, b))
<span class="py-output">('za,xza', 'xz', [a, b]) # may vary</span>
</pre><pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>_parse_einsum_input((a, [<span class="py-builtin">Ellipsis</span>, 0], b, [<span class="py-builtin">Ellipsis</span>, 0]))
<span class="py-output">('za,xza', 'xz', [a, b]) # may vary</span>
</pre></div>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td colspan="2"><ul class="rst-simple">
<li><strong>input_strings</strong>: <code><a href="https://docs.python.org/3/library/stdtypes.html#str" class="intersphinx-link">str</a></code> - Parsed input strings</li>
<li><strong>output_string</strong>: <code><a href="https://docs.python.org/3/library/stdtypes.html#str" class="intersphinx-link">str</a></code> - Parsed output string</li>
<li><strong>operands</strong>: <code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code> of <code>array_like</code> - The operands to use in the numpy contraction</li>
</ul>
</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="numpy.core.einsumfunc._parse_possible_contraction">
    
  </a>
  <a name="_parse_possible_contraction">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_parse_possible_contraction</span><span class="function-signature">(positions, input_sets, output_set, idx_dict, memory_limit, path_cost, naive_cost)</span>:
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L215">
      
      (source)
    </a>
    <a class="headerLink" href="#_parse_possible_contraction" title="numpy.core.einsumfunc._parse_possible_contraction">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Compute the cost (removed size + flops) and resultant indices for
performing the contraction specified by <tt class="rst-docutils literal">positions</tt>.</p><table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">positions:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#tuple" class="intersphinx-link">tuple</a></code> of <code><a href="https://docs.python.org/3/library/functions.html#int" class="intersphinx-link">int</a></code></td><td class="fieldArgDesc">The locations of the proposed tensors to contract.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">input<wbr></wbr>_sets:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code> of <code>sets</code></td><td class="fieldArgDesc">The indices found on each tensors.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">output<wbr></wbr>_set:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#set" class="intersphinx-link">set</a></code></td><td class="fieldArgDesc">The output indices of the expression.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">idx<wbr></wbr>_dict:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#dict" class="intersphinx-link">dict</a></code></td><td class="fieldArgDesc">Mapping of each index to its size.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">memory<wbr></wbr>_limit:</span><code><a href="https://docs.python.org/3/library/functions.html#int" class="intersphinx-link">int</a></code></td><td class="fieldArgDesc">The total allowed size for an intermediary tensor.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">path<wbr></wbr>_cost:</span><code><a href="https://docs.python.org/3/library/functions.html#int" class="intersphinx-link">int</a></code></td><td class="fieldArgDesc">The contraction cost so far.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">naive<wbr></wbr>_cost:</span><code><a href="https://docs.python.org/3/library/functions.html#int" class="intersphinx-link">int</a></code></td><td class="fieldArgDesc">The cost of the unoptimized expression.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td colspan="2"><ul class="rst-simple">
<li><strong>cost</strong>: (<code><a href="https://docs.python.org/3/library/functions.html#int" class="intersphinx-link">int</a></code>, <code><a href="https://docs.python.org/3/library/functions.html#int" class="intersphinx-link">int</a></code>) - A tuple containing the size of any indices removed, and the flop cost.</li>
<li><strong>positions</strong>: <code><a href="https://docs.python.org/3/library/stdtypes.html#tuple" class="intersphinx-link">tuple</a></code> of <code><a href="https://docs.python.org/3/library/functions.html#int" class="intersphinx-link">int</a></code> - The locations of the proposed tensors to contract.</li>
<li><strong>new_input_sets</strong>: <code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code> of <code>sets</code> - The resulting new list of indices if this proposed contraction is performed.</li>
</ul>
</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="numpy.core.einsumfunc._update_other_results">
    
  </a>
  <a name="_update_other_results">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_update_other_results</span><span class="function-signature">(results, best)</span>:
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/numpy-1.24.2//numpy/core/einsumfunc.py#L273">
      
      (source)
    </a>
    <a class="headerLink" href="#_update_other_results" title="numpy.core.einsumfunc._update_other_results">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Update the positions and provisional input_sets of <tt class="rst-docutils literal">results</tt> based on
performing the contraction result <tt class="rst-docutils literal">best</tt>. Remove any involving the tensors
contracted.</p><table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">results:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code></td><td class="fieldArgDesc">List of contraction results produced by <tt class="rst-docutils literal">_parse_possible_contraction</tt>.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">best:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code></td><td class="fieldArgDesc">The best contraction of <tt class="rst-docutils literal">results</tt> i.e. the one that will be performed.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code></td><td class="fieldArgDesc"><strong>mod_results</strong> - The list of modified results, updated with outcome of <tt class="rst-docutils literal">best</tt> contraction.</td></tr></table></div>
  </div>
</div>
        </div>
      
      </div>
    </div>

    <footer class="navbar navbar-default">

  
  <div class="container">
    <a href="index.html">API Documentation</a> for numpy,
  generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
    22.9.1.dev0 at 2023-02-06 00:57:38.
  </div>

  <!-- Search related scripts needs to be loaded at the end of HTML 
    parsing not to introduce overhead and display HTML data asap -->
  <script src="ajax.js" type="text/javascript"></script>
  <script src="searchlib.js" type="text/javascript"></script>
  <script src="search.js" type="text/javascript"></script>

</footer>
  
    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>